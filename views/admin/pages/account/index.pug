extends ../../layout/default.pug
include ../../mixins/box-header.pug

block main
  // Hero Header Section
  .hero-header.position-relative.mb-5
    .bg-gradient-modern.py-5.px-4.rounded-3xl.shadow-xl.overflow-hidden
      .hero-particles
      .container-fluid.position-relative(style="z-index: 2;")
        .row.align-items-center
          .col-md-8
            .hero-content.text-white
              .d-flex.align-items-center.mb-3
                .hero-icon.mr-4
                  i.fas.fa-users
                .hero-text
                  h1.mb-2.hero-title(style="font-size: 3rem; font-weight: 800; letter-spacing: 2px;")
                    +box-head(titlePage)
                  p.hero-subtitle.mb-0.opacity-90 Quản lý thông tin người dùng và phân quyền hệ thống
          .col-md-4.text-right
            .stats-dashboard
              .stats-card.bg-glass.backdrop-blur
                .stats-icon
                  i.fas.fa-chart-bar
                .stats-content
                  .stats-number.text-white #{records ? records.length : 0}
                  .stats-label.text-white-75 Tổng tài khoản

  // Navigation & Actions Bar
  .nav-actions.mb-4
    .bg-glass-white.p-4.rounded-2xl.shadow-lg.backdrop-blur
      .row.align-items-center
        .col-md-6
          nav.breadcrumb-modern.mb-0
            .breadcrumb-item
              i.fas.fa-home.mr-2.text-primary
              span.text-muted Trang chủ
            .breadcrumb-divider
              i.fas.fa-chevron-right.text-muted.mx-3
            .breadcrumb-item.active
              i.fas.fa-users.mr-2.text-primary
              span.font-weight-600.text-dark Quản lý tài khoản
        .col-md-6.text-right
          .action-buttons
            a(
              href=`${prefixAdmin}/accounts/create`
              class="btn btn-gradient-success btn-lg px-4 py-3 rounded-pill shadow-lg hover-lift"
            )
              i.fas.fa-user-plus.mr-2
              span.font-weight-600 Thêm tài khoản mới
              .btn-shine

  // Main Content Card
  .main-card
    .card.border-0.shadow-2xl.rounded-3xl.overflow-hidden
      // Card Header
      .card-header.bg-gradient-header.border-0.py-4
        .container-fluid
          .row.align-items-center
            .col-md-6
              .card-title.d-flex.align-items-center.text-white
                .title-icon.mr-3
                  i.fas.fa-table
                .title-text
                  h4.mb-1.font-weight-700 Danh sách tài khoản
                  p.mb-0.opacity-80.small Quản lý và theo dõi thông tin người dùng
            .col-md-6.text-right
              .search-container.position-relative
                .search-box
                  i.fas.fa-search.search-icon
                  input.search-input.form-control(
                    type="text" 
                    placeholder="Tìm kiếm theo tên, email..."
                    id="searchInput"
                  )
                  .search-bg

      // Table Container
      .card-body.p-0
        .table-container
          .table-responsive
            table.table.table-hover.table-borderless.mb-0.modern-table(multiTable)
              thead.table-header-modern
                tr
                  th.text-center.py-4.border-0.table-header-cell
                    .custom-checkbox-modern
                      input.form-check-input(type="checkbox" name="check-all" id="checkAll")
                      label.form-check-label(for="checkAll")
                        .checkbox-custom
                  th.text-center.py-4.border-0.table-header-cell
                    .header-content
                      i.fas.fa-hashtag.mr-2
                      span.font-weight-700 STT
                  th.text-center.py-4.border-0.table-header-cell
                    .header-content
                      i.fas.fa-user-circle.mr-2
                      span.font-weight-700 Thông tin
                  th.text-center.py-4.border-0.table-header-cell
                    .header-content
                      i.fas.fa-shield-alt.mr-2
                      span.font-weight-700 Quyền hạn
                  th.text-center.py-4.border-0.table-header-cell
                    .header-content
                      i.fas.fa-envelope.mr-2
                      span.font-weight-700 Liên hệ
                  th.text-center.py-4.border-0.table-header-cell
                    .header-content
                      i.fas.fa-toggle-on.mr-2
                      span.font-weight-700 Trạng thái
                  th.text-center.py-4.border-0.table-header-cell
                    .header-content
                      i.fas.fa-cogs.mr-2
                      span.font-weight-700 Hành động

              tbody.table-body-modern
                each item, index in records
                  tr.table-row-modern.hover-elevate(data-index=index)
                    // Checkbox
                    td.text-center.py-4.align-middle
                      .custom-checkbox-modern
                        input.form-check-input(type="checkbox" name="id" value=item.id id=`check${item.id}`)
                        label.form-check-label(for=`check${item.id}`)
                          .checkbox-custom

                    // STT
                    td.text-center.align-middle.py-4
                      .stt-badge #{index+1}

                    // User Info
                    td.text-center.py-4.align-middle
                      .user-info-card
                        .user-avatar.position-relative
                          img.avatar-image(
                            src=item.avatar || "/images/default-avatar.png"
                            alt="Avatar"
                          )
                          .avatar-status.position-absolute
                        .user-details.mt-3
                          .user-name.font-weight-700.text-dark #{item.username}
                          .user-id.text-muted.small ID: #{item.id}

                    // Role
                    td.text-center.align-middle.py-4
                      .role-badge
                        i.fas.fa-crown.mr-2
                        span #{item.role.title}

                    // Contact
                    td.text-center.align-middle.py-4
                      .contact-info
                        .email-info.mb-2
                          i.fas.fa-envelope.mr-2.text-primary
                          span.text-dark #{item.email}
                        .phone-info
                          if item.phone
                            i.fas.fa-phone.mr-2.text-success
                            span.text-muted #{item.phone}
                          else
                            i.fas.fa-phone-slash.mr-2.text-muted
                            span.text-muted Chưa cập nhật

                    // Status
                    td.text-center.align-middle.py-4
                      if item.status == 'active'
                        .status-toggle.status-active(
                          data-id=item.id
                          data-status=item.status
                          button-change-status
                        )
                          .status-slider
                          .status-text HOẠT ĐỘNG
                      else
                        .status-toggle.status-inactive(
                          data-id=item.id
                          data-status=item.status
                          button-change-status
                        )
                          .status-slider
                          .status-text TẠM DỪNG

                    // Actions
                    td.text-center.align-middle.py-4
                      .action-group
                        a.action-btn.action-view(
                          href=`${prefixAdmin}/accounts/detail/${item.id}`
                          title="Xem chi tiết"
                          data-tooltip="Xem chi tiết"
                        )
                          i.fas.fa-eye

                        a.action-btn.action-edit(
                          href=`${prefixAdmin}/accounts/edit/${item.id}`
                          title="Chỉnh sửa"
                          data-tooltip="Chỉnh sửa"
                        )
                          i.fas.fa-edit

                        button.action-btn.action-delete(
                          type="button"
                          data-id=item.id
                          data-toggle="modal"
                          data-target="#exampleModal"
                          button-delete
                          button-delete-product
                          title="Xóa tài khoản"
                          data-tooltip="Xóa"
                        )
                          i.fas.fa-trash-alt

  // Custom Styles
  style.
    /* Modern Gradients */
    .bg-gradient-modern {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      position: relative;
    }
    
    .bg-gradient-header {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }
    
    .bg-glass {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .bg-glass-white {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    /* Hero Section */
    .hero-header {
      margin-bottom: 2rem;
    }
    
    .hero-particles {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="30" r="1.5" fill="rgba(255,255,255,0.1)"/><circle cx="40" cy="70" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="90" cy="80" r="2.5" fill="rgba(255,255,255,0.1)"/></svg>');
      animation: float 20s infinite linear;
    }
    
    @keyframes float {
      0% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(180deg); }
      100% { transform: translateY(0px) rotate(360deg); }
    }
    
    .hero-icon {
      width: 80px;
      height: 80px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 255, 255, 0.3);
    }
    
    .hero-icon i {
      font-size: 2.5rem;
      color: white;
    }
    
    .rounded-3xl {
      border-radius: 2rem !important;
    }
    
    .shadow-xl {
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25) !important;
    }
    
    .shadow-2xl {
      box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.3) !important;
    }

    /* Stats Card */
    .stats-dashboard {
      display: flex;
      justify-content: flex-end;
    }
    
    .stats-card {
      padding: 2rem;
      border-radius: 1.5rem;
      text-align: center;
      min-width: 200px;
      position: relative;
      overflow: hidden;
    }
    
    .stats-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
      transform: translateX(-100%);
      transition: transform 0.6s;
    }
    
    .stats-card:hover::before {
      transform: translateX(100%);
    }
    
    .stats-icon {
      font-size: 2rem;
      margin-bottom: 1rem;
      color: rgba(255, 255, 255, 0.8);
    }
    
    .stats-number {
      font-size: 3.5rem;
      font-weight: 900;
      color: white;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      margin-bottom: 0.5rem;
    }
    
    .stats-label {
      color: rgba(255, 255, 255, 0.9);
      font-weight: 600;
      font-size: 1.1rem;
    }

    /* Navigation */
    .breadcrumb-modern {
      display: flex;
      align-items: center;
    }
    
    .breadcrumb-item {
      display: flex;
      align-items: center;
    }

    /* Buttons */
    .btn-gradient-success {
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      border: none;
      color: white;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
      box-shadow: 0 8px 25px rgba(17, 153, 142, 0.3);
    }
    
    .btn-gradient-success:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 35px rgba(17, 153, 142, 0.4);
      color: white;
    }
    
    .btn-shine {
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s;
    }
    
    .btn-gradient-success:hover .btn-shine {
      left: 100%;
    }
    
    .hover-lift:hover {
      transform: translateY(-3px);
    }

    /* Search Box */
    .search-container {
      max-width: 350px;
      margin-left: auto;
    }
    
    .search-box {
      position: relative;
    }
    
    .search-input {
      background: rgba(255, 255, 255, 0.9);
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 2rem;
      padding: 1rem 1.5rem 1rem 3.5rem;
      font-size: 1rem;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }
    
    .search-input:focus {
      border-color: rgba(255, 255, 255, 0.8);
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.2);
      background: white;
    }
    
    .search-icon {
      position: absolute;
      left: 1.2rem;
      top: 50%;
      transform: translateY(-50%);
      color: rgba(255, 255, 255, 0.7);
      font-size: 1.1rem;
      z-index: 5;
    }

    /* Table Styles */
    .modern-table {
      font-size: 0.95rem;
    }
    
    .table-header-modern {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .table-header-cell {
      color: white;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-size: 0.85rem;
    }
    
    .header-content {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .table-row-modern {
      transition: all 0.3s ease;
      border-bottom: 1px solid #f8f9fa;
    }
    
    .table-row-modern:hover {
      background: linear-gradient(135deg, #f8f9ff 0%, #f0f4ff 100%);
    }
    
    .hover-elevate:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.05);
    }

    /* STT Badge */
    .stt-badge {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 700;
      font-size: 1.1rem;
      margin: 0 auto;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    /* User Info Card */
    .user-info-card {
      text-align: center;
      padding: 1rem;
    }
    
    .user-avatar {
      display: inline-block;
      margin-bottom: 1rem;
    }
    
    .avatar-image {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid #fff;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
    }
    
    .avatar-image:hover {
      transform: scale(1.1);
      box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15);
    }
    
    .avatar-status {
      width: 20px;
      height: 20px;
      background: #28a745;
      border-radius: 50%;
      bottom: 5px;
      right: 5px;
      border: 3px solid white;
    }
    
    .user-name {
      font-size: 1.1rem;
      color: #2d3748;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .user-id {
      font-size: 0.8rem;
      background: #f7fafc;
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
      display: inline-block;
      margin-top: 0.5rem;
    }

    /* Role Badge */
    .role-badge {
      display: inline-flex;
      align-items: center;
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: 2rem;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
      transition: all 0.3s ease;
    }
    
    .role-badge:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4);
    }

    /* Contact Info */
    .contact-info {
      text-align: left;
      max-width: 250px;
      margin: 0 auto;
    }
    
    .email-info, .phone-info {
      display: flex;
      align-items: center;
      padding: 0.5rem;
      border-radius: 0.5rem;
      transition: all 0.3s ease;
    }
    
    .email-info:hover, .phone-info:hover {
      background: #f8f9fa;
    }

    /* Status Toggle */
    .status-toggle {
      display: inline-flex;
      align-items: center;
      padding: 0.75rem 1.5rem;
      border-radius: 2rem;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      position: relative;
      overflow: hidden;
    }
    
    .status-active {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
    }
    
    .status-inactive {
      background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
    }
    
    .status-toggle:hover {
      transform: translateY(-2px);
    }
    
    .status-slider {
      width: 20px;
      height: 20px;
      background: white;
      border-radius: 50%;
      margin-right: 0.75rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    /* Action Buttons */
    .action-group {
      display: flex;
      gap: 0.5rem;
      justify-content: center;
    }
    
    .action-btn {
      width: 45px;
      height: 45px;
      border: none;
      border-radius: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
      text-decoration: none;
      font-size: 1rem;
    }
    
    .action-view {
      background: linear-gradient(135deg, #17a2b8 0%, #20c997 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(23, 162, 184, 0.3);
    }
    
    .action-edit {
      background: linear-gradient(135deg, #fd7e14 0%, #ffc107 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(253, 126, 20, 0.3);
    }
    
    .action-delete {
      background: linear-gradient(135deg, #dc3545 0%, #e83e8c 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
    }
    
    .action-btn:hover {
      transform: translateY(-3px) scale(1.05);
      color: white;
      text-decoration: none;
    }
    
    .action-view:hover {
      box-shadow: 0 8px 25px rgba(23, 162, 184, 0.4);
    }
    
    .action-edit:hover {
      box-shadow: 0 8px 25px rgba(253, 126, 20, 0.4);
    }
    
    .action-delete:hover {
      box-shadow: 0 8px 25px rgba(220, 53, 69, 0.4);
    }

    /* Custom Checkbox */
    .custom-checkbox-modern {
      display: flex;
      justify-content: center;
    }
    
    .custom-checkbox-modern input[type="checkbox"] {
      display: none;
    }
    
    .checkbox-custom {
      width: 24px;
      height: 24px;
      border: 2px solid #dee2e6;
      border-radius: 6px;
      background: white;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }
    
    .custom-checkbox-modern input[type="checkbox"]:checked + label .checkbox-custom {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-color: #667eea;
    }
    
    .custom-checkbox-modern input[type="checkbox"]:checked + label .checkbox-custom::after {
      content: '✓';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-weight: bold;
      font-size: 14px;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .hero-header .row {
        flex-direction: column;
        text-align: center;
      }
      
      .stats-dashboard {
        justify-content: center;
        margin-top: 2rem;
      }
      
      .nav-actions .row {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
      }
      
      .card-header .row {
        flex-direction: column;
        gap: 1rem;
      }
      
      .search-container {
        max-width: 100%;
      }
      
      .hero-title {
        font-size: 2rem !important;
      }
      
      .action-group {
        flex-wrap: wrap;
      }
      
      .contact-info {
        text-align: center;
      }
    }

    /* Animations */
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .table-row-modern {
      animation: slideIn 0.5s ease-out;
    }
    
    .table-row-modern:nth-child(even) {
      animation-delay: 0.1s;
    }
    
    .table-row-modern:nth-child(odd) {
      animation-delay: 0.2s;
    }

    /* Utilities */
    .text-white-75 {
      color: rgba(255, 255, 255, 0.75) !important;
    }
    
    .backdrop-blur {
      backdrop-filter: blur(20px);
    }
    
    .font-weight-700 {
      font-weight: 700 !important;
    }
    
    .font-weight-900 {
      font-weight: 900 !important;
    }